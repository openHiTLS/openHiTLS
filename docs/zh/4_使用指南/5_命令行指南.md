# 1 概述

openHiTLS命令源码位于apps目录下，编译结果为hitls，用户可运行hitls命令来进行多种密码学操作。该工具提供了完整的密码学功能套件，包括随机数生成、对称/非对称加密、数字签名、PKI证书管理以及SSL/TLS连接等功能。

## 1.1 支持的命令列表
|命令类别|命令名称|描述|
|-|-|-|
|**基础命令**| | |
||help|显示帮助信息和支持的命令列表|
||list|列出支持的算法和功能，包括摘要、对称、非对称、MAC、随机数、KDF算法等 |
|**随机数生成**|| |
||rand|生成指定长度的随机数，支持十六进制和Base64编码输出 |
|**密码处理**|| |
||passwd|生成和验证密码哈希，支持SHA512等算法 |
|**加密和解密**|| |
||enc|对称加密和解密操作，支持多种对称算法 |
||mac|消息认证码计算和验证 |
||dgst|消息摘要计算和数字签名操作 |
||kdf|密钥派生函数，从输入材料派生密钥 |
|**密钥和参数管理**|| |
||rsa|RSA密钥处理，包括格式转换和信息显示 |
||genrsa|生成RSA私钥 |
||genpkey|生成各种类型的公钥、私钥 |
||pkey|公钥私钥处理工具 |
||pkeyutl|使用密钥进行加密、解密、签名、验证等操作 |
||keymgmt|密钥管理功能，包括密钥创建、删除、查询等（SM模式） |
|**PKI证书管理**|| |
||pkcs12|PKCS#12格式证书和密钥包的处理 |
||x509|X.509证书的生成、解析、转换和验证 |
||crl|证书撤销列表的生成和管理 |
||verify|证书链验证和信任关系检查 |
||req|证书签名请求的生成和处理 |
|**SSL/TLS通信**|| |
||s_client|SSL/TLS客户端工具 |
||s_server|SSL/TLS服务器工具 |

## 1.2 命令使用方式

```bash
hitls <command> [options]
```

其中`<command>`为具体的功能命令，`[options]`为该命令的参数选项。每个命令都支持`-help`选项来查看详细的使用说明。

# 2 选项

## 2.1 Provider选项

- `-provider <name>`：指定Provider的名称，也可以是Provider的路径，命令行加载并初始化此名称标识的Provider。
- `-provider-path`：指定Provider的搜索路径，与`-provider <name>`配合使用，此路径被附加到name的前面。
- `-provider-attr`：指定Provider获取算法时要使用的属性查询子句，有更详细的描述，请参阅[provider开发指南](../5_开发指南/4_provider开发指南.md#32-属性查询和provider打分机制)。

# 3 命令

## 3.1 基础命令

### 3.1.1 help

**功能**：显示所有支持的命令或特定命令的帮助信息

**用法**：

```
hitls help [命令名称]
```

**参数**：
- 无参数：显示所有支持的命令列表
- 命令名称：显示特定命令的详细帮助信息

**示例**：

```bash
hitls help                # 显示所有支持的命令
hitls help rand           # 显示rand命令的帮助信息
```

### 3.1.2 list

**功能**：列出支持的算法和功能，包括摘要、对称、非对称、MAC、随机数、KDF算法等

**用法**：
```
hitls list [-help] [-all-algorithms] [-digest-algorithms] [-cipher-algorithms] [-asym-algorithms] [-mac-algorithms] [-rand-algorithms] [-kdf-algorithms] [-all-curves]
```

**支持的选项**：
- `-help`： 显示帮助信息
- `-all-algorithms`：列出所有支持的算法
- `-digest-algorithms`：列出所有支持的摘要算法
- `-cipher-algorithms`：列出所有支持的对称算法
- `-asym-algorithms`：列出所有支持的非对称算法
- `-mac-algorithms`：列出所有支持的MAC算法
- `-rand-algorithms`：列出所有支持的随机数算法
- `-kdf-algorithms`：列出所有支持的KDF算法
- `-all-curves`：列出所有支持的曲线

**示例**：
```bash
hitls list -all-algorithms
hitls list -cipher-algorithms
hitls list -all-curves
```

## 3.2 随机数生成

### 3.2.1 rand

**功能**：生成随机数据
**用法**：

```
hitls rand [-help] [-out file] [-algorithm alg] [-hex] [-base64] [-provider name] [-provider-path path] [-provider-attr attr] numbytes
```

**支持的选项**：
- `-help`：显示帮助信息
- `-hex`：以十六进制格式输出
- `-base64`：以Base64格式输出
- `-out <文件>`：将输出写入指定文件，若未指定，输出至stdout
- `-algorithm <算法>`：指定随机数生成算法，支持的随机数算法可使用[list](#312-list)命令查看
- `-provider`,`-provider-path`, `-provider-attr`：请参阅[Provider选项](#21-provider选项)

**示例**：
```bash
# 生成16字节随机数据，以二进制格式输出
hitls rand 16

# 生成32字节随机数据，以十六进制格式输出
hitls rand -hex 32

# 生成64字节随机数据，以Base64格式保存到rand.txt
hitls rand -base64 -out rand.txt 64

# 使用hmac-sha256随机数算法生成10字节随机数据，以十六进制格式输出
hitls rand -algorithm hmac-sha256 -hex 10
```

## 3.3 密码处理

### 3.3.1 passwd
生成和验证密码哈希，支持SHA512等算法

## 3.4 加密和解密

### 3.4.1 enc
对称加密和解密操作，支持多种对称算法

### 3.4.2 mac
消息认证码计算和验证

### 3.4.3 dgst
消息摘要计算和数字签名操作

### 3.4.4 kdf
密钥派生函数，从输入材料派生密钥

## 3.5 密钥和参数管理

### 3.5.1 rsa
RSA密钥处理，包括格式转换和信息显示

### 3.5.2 genrsa
生成RSA私钥

### 3.5.3 genpkey
生成各种类型的公钥、私钥

### 3.5.4 pkey
公钥私钥处理工具

### 3.5.5 pkeyutl
使用密钥进行加密、解密、签名、验证等操作

### 3.5.6 keymgmt
密钥管理功能，包括密钥创建、删除、查询等（SM模式） 

## 3.6 PKI证书管理

### 3.6.1 pkcs12
PKCS#12格式证书和密钥包的处理

### 3.6.2 x509
X.509证书的生成、解析、转换和验证

### 3.6.3 crl
证书撤销列表的生成和管理

### 3.6.4 verify
证书链验证和信任关系检查

### 3.6.5 req
证书签名请求的生成和处理 

## 3.7 SSL/TLS通信

### 3.7.1 s_client
SSL/TLS客户端工具

### 3.7.2 s_server
SSL/TLS服务器工具
